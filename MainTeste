import lejos.hardware.Button;
import lejos.hardware.LED;
import lejos.hardware.Sound;
import lejos.hardware.motor.EV3LargeRegulatedMotor;
import lejos.hardware.port.MotorPort;
import lejos.utility.Delay;

public class MainTesteSEK {
	private static EV3LargeRegulatedMotor motorEsq = new EV3LargeRegulatedMotor(
			MotorPort.A);
	private static EV3LargeRegulatedMotor motorDir = new EV3LargeRegulatedMotor(
			MotorPort.C);
	private static EV3LargeRegulatedMotor motorPorta = new EV3LargeRegulatedMotor(
			MotorPort.B);

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		Reconhecimento reconhecimento = new Reconhecimento();
		Thread thReconhecimento = new Thread(reconhecimento);
		thReconhecimento.start();
		Sound.beepSequenceUp();
		while (!Button.ENTER.isDown()) {
		}

		while (!Button.ESCAPE.isDown()) {
			Button.LEDPattern(0);
			if (Reconhecimento.getBoneco()) {
				parar();
				procurar();
				if (Reconhecimento.getPreto()) {
					Button.LEDPattern(1);
					ré();
					Delay.msDelay(400);
					parar();
					abrirPorta();
					andar();
					Delay.msDelay(1200);
					parar();
					fecharPorta();
					Button.LEDPattern(0);
				} else {
					Button.LEDPattern(2);
					Delay.msDelay(1000);
				}
			} else {
				parar();
			}
		}
	}

	private static void andar() {
		motorEsq.setSpeed(300);
		motorDir.setSpeed(300);
		motorDir.forward();
		motorEsq.forward();
	}

	private static void parar() {
		motorEsq.stop(true);
		motorDir.stop();
	}

	private static void ré() {
		motorEsq.backward();
		motorDir.backward();
	}

	private static void procurar() {
		motorDir.setSpeed(200);
		motorEsq.setSpeed(200);
		motorDir.rotate(45, true);
		motorEsq.rotate(-45);
		Delay.msDelay(100);
		motorEsq.rotate(90, true);
		motorDir.rotate(-90);
		Delay.msDelay(100);
		motorDir.rotate(45, true);
		motorEsq.rotate(-45);
	}

	private static void virarEsquerda() {
		motorEsq.stop(true);
		motorDir.forward();
	}

	private static void virarDireita() {
		motorDir.stop(true);
		motorEsq.forward();
	}

	private static void desviarEsq() {
		parar();
		ré();
		Delay.msDelay(1500);
		virarEsquerda();
		Delay.msDelay(2000);
		andar();
		Delay.msDelay(2000);
		virarDireita();
		Delay.msDelay(2000);
		andar();
		Delay.msDelay(1000);
		virarDireita();
		Delay.msDelay(2000);
		andar();
		Delay.msDelay(2000);
		virarEsquerda();
		Delay.msDelay(2000);
	}

	private static void abrirPorta() {
		motorPorta.setSpeed(300);
		motorPorta.rotate(-100);
	}

	private static void fecharPorta() {
		motorPorta.setSpeed(300);
		motorPorta.rotate(100);
	}

}
